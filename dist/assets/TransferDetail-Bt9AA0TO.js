import{r,j as e}from"./react-PleRxLNr.js";import{u as S,t as d}from"./index-ByeexPDm.js";import{d as E,u as D}from"./router-CwZiKTye.js";import{a as T,v as A,x,i as u,C as p,y as P,U as j,z as y,c as N,D as R,F as B,q as L,o as M}from"./lucide-DAQsc5bm.js";const f={pending:{label:"En attente",color:"bg-amber-100 text-amber-800",icon:p},in_progress:{label:"En cours",color:"bg-purple-100 text-purple-800",icon:p},paid:{label:"Payé",color:"bg-emerald-100 text-emerald-800",icon:u},cancelled:{label:"Annulé",color:"bg-red-100 text-red-800",icon:x}},k={cash:"Espèces",zelle:"Zelle",orange_money:"Orange Money",wave:"Wave",bank_transfer:"Virement bancaire"},U=()=>{const{id:l}=E(),n=D(),{user:m}=S(),[s,b]=r.useState(null),[v,o]=r.useState(!0),[h,g]=r.useState(null);r.useEffect(()=>{if(!l)return;(async()=>{o(!0),g(null);try{const a=await d.getById(l);b(a)}catch(a){g(a.message||"Erreur lors du chargement du transfert")}finally{o(!1)}})()},[l]);const c=t=>new Date(t).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),w=async()=>{if(s&&confirm(`Êtes-vous sûr de vouloir supprimer le transfert ${s.reference} ?

Cette action est irréversible.`))try{await d.delete(s.id),n("/transfers")}catch(t){alert(t.message||"Erreur lors de la suppression")}};if(!m)return null;if(v)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[50vh] gap-4",children:[e.jsx(T,{className:"w-10 h-10 text-emerald-600 animate-spin"}),e.jsx("p",{className:"text-gray-600",children:"Chargement des détails..."})]});if(h||!s)return e.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-xl p-6 text-center",children:[e.jsx(A,{className:"w-8 h-8 text-red-500 mx-auto mb-2"}),e.jsx("p",{className:"text-red-700",children:h||"Transfert non trouvé"}),e.jsx("button",{onClick:()=>n("/transfers"),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Retour à la liste"})]});const i=f[s.status]||f.pending,C=i.icon;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>n("/transfers"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(P,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-emerald-600",children:s.reference}),e.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium ${i.color}`,children:[e.jsx(C,{className:"w-4 h-4"}),i.label]})]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Détails du transfert"})]})]}),m.role==="admin"&&e.jsxs("button",{onClick:w,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4"}),"Supprimer"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5 text-blue-600"}),"Expéditeur"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Nom complet"}),e.jsxs("p",{className:"text-base font-medium text-gray-900",children:[s.sender.firstName," ",s.sender.lastName]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-4 h-4 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.sender.phone})]}),s.sender.email&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Email"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.sender.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.sender.country})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5 text-emerald-600"}),"Bénéficiaire"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Nom complet"}),e.jsxs("p",{className:"text-base font-medium text-gray-900",children:[s.beneficiary.firstName," ",s.beneficiary.lastName]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-4 h-4 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.beneficiary.phone})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4 text-gray-400"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.beneficiary.city,", ",s.beneficiary.country]})]}),s.beneficiary.idType&&s.beneficiary.idNumber&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Pièce d'identité"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.beneficiary.idType,": ",s.beneficiary.idNumber]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5 text-emerald-600"}),"Informations financières"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Montant envoyé"}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[s.amountSent.toLocaleString()," ",s.currencySent]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Frais"}),e.jsxs("p",{className:"text-xl font-bold text-amber-600",children:[s.fees.toLocaleString()," ",s.currencySent]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Montant à remettre"}),e.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:[s.amountReceived.toLocaleString()," ",s.currencyReceived]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Taux de change"}),e.jsxs("p",{className:"text-base text-gray-900",children:["1 ",s.currencySent," = ",s.exchangeRate," ",s.currencyReceived]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Méthode de paiement"}),e.jsx("p",{className:"text-base text-gray-900",children:k[s.sendMethod]||s.sendMethod})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-gray-600"}),"Informations système"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Créé par"}),e.jsxs("p",{className:"text-base font-medium text-gray-900",children:[s.createdBy.name,s.createdBy.country&&e.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",s.createdBy.country,")"]})]})]}),s.paidBy&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Payé par"}),e.jsx("p",{className:"text-base font-medium text-gray-900",children:s.paidBy.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Date de création"}),e.jsx("p",{className:"text-sm text-gray-600",children:c(s.createdAt)})]})]}),s.paidAt&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-4 h-4 text-emerald-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Date de paiement"}),e.jsx("p",{className:"text-sm text-gray-600",children:c(s.paidAt)})]})]}),s.cancelledAt&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4 text-red-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Date d'annulation"}),e.jsx("p",{className:"text-sm text-gray-600",children:c(s.cancelledAt)})]})]}),s.proofFilePath&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Preuve de paiement"}),e.jsxs("button",{onClick:async()=>{try{await d.downloadProof(s.id)}catch(t){alert(t.message||"Erreur lors du téléchargement")}},className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors",children:[e.jsx(M,{className:"w-4 h-4"}),"Télécharger la preuve"]})]}),s.confirmationComment&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Commentaire de confirmation"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.confirmationComment})]}),s.notes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.notes})]}),s.cancellationReason&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Raison d'annulation"}),e.jsx("p",{className:"text-sm text-red-600 mt-1",children:s.cancellationReason})]})]})]})]})]})};export{U as TransferDetail};
