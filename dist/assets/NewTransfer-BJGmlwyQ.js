import{r as c,j as e}from"./react-PleRxLNr.js";import{u as fe,b as be,c as ye,t as Ne}from"./index-ByeexPDm.js";import{u as je}from"./router-CwZiKTye.js";import{y as Q,U as S,D as ae,i as f,z as Z,e as ve,G as we,I as Se,J as Ce,K as k,N as Fe,F as ke,c as Ae,O as Y,Q as Re,q as Ee,V as Te,H as Me,p as Be}from"./lucide-DAQsc5bm.js";const w={USD_XOF:615},g=(t,m)=>m==="USD"?t>1e3?Math.floor(t/1e3)*20:t>=1&&t<=100?5:t>=101&&t<=200?8:t>=201&&t<=500?10:t>=501&&t<=800?15:t>=801&&t<=1e3?20:5:m==="XOF"?t>615e3?Math.floor(t/615e3)*12300:t>=1&&t<=61500?3075:t>=61501&&t<=123e3?4920:t>=123001&&t<=307500?6150:t>=307501&&t<=492e3?9225:t>=492001&&t<=615e3?12300:3075:m==="USD"?5:3075,ee=[{id:1,title:"Exp√©diteur",icon:S},{id:2,title:"B√©n√©ficiaire",icon:S},{id:3,title:"Montant",icon:ae},{id:4,title:"Confirmation",icon:f}],N=[{code:"USA",name:"√âtats-Unis",currency:"USD",flag:"üá∫üá∏"},{code:"BFA",name:"Burkina Faso",currency:"XOF",flag:"üáßüá´"}],C=[{code:"BFA",name:"Burkina Faso",currency:"XOF",flag:"üáßüá´"},{code:"USA",name:"√âtats-Unis",currency:"USD",flag:"üá∫üá∏"}],se=[{id:"cash",label:"Cash",icon:Ce},{id:"zelle",label:"Zelle",icon:k},{id:"orange_money",label:"Orange Money",icon:k},{id:"wave",label:"Wave",icon:k},{id:"bank_transfer",label:"Virement",icon:Fe}],F=t=>!!t&&(t==="BFA"||t==="Burkina Faso"||t.toLowerCase().includes("burkina")),te=t=>{const m=F(t);return{send:m?"BFA":"USA",receive:m?"USA":"BFA"}},Ue=t=>F(t)?N.filter(m=>m.code==="BFA"):N.filter(m=>m.code==="USA"),Oe=t=>F(t)?C.filter(m=>m.code==="USA"):C.filter(m=>m.code==="BFA"),Le=()=>{var G,K,J;const{user:t}=fe(),m=je(),[d,j]=c.useState(1),[A,R]=c.useState(!1),[E,T]=c.useState(""),[ne,M]=c.useState(!1),B=te(t==null?void 0:t.country),[l,x]=c.useState({firstName:"",lastName:"",phone:"",email:"",country:B.send,sendMethod:"cash"}),[n,o]=c.useState({firstName:"",lastName:"",phone:"",idType:"none",idNumber:"",country:B.receive,city:""}),[a,h]=c.useState({amountSent:0,currency:"USD",exchangeRate:w.USD_XOF,useAutoRate:!0,fees:0}),[b,U]=c.useState(!1),[O,D]=c.useState([]),[I,P]=c.useState([]),[le,$]=c.useState(!1),[re,L]=c.useState(!1),[ie,X]=c.useState(null),[ce,_]=c.useState(null);c.useEffect(()=>{l.country&&(X(null),$(!0),be.getAll({country:l.country,limit:200}).then(s=>D(s.data||[])).catch(()=>D([])).finally(()=>$(!1)))},[l.country]),c.useEffect(()=>{n.country&&(_(null),L(!0),ye.getAll({country:n.country,limit:200}).then(s=>P(s.data||[])).catch(()=>P([])).finally(()=>L(!1)))},[n.country]),c.useEffect(()=>{if(!(t!=null&&t.country))return;const{send:s,receive:r}=te(t.country);x(i=>i.country===s?i:{...i,country:s}),o(i=>i.country===r?i:{...i,country:r})},[t==null?void 0:t.country]),c.useEffect(()=>{const s=N.find(r=>r.code===l.country);if(s){const r=`${s.currency}_XOF`;h(i=>({...i,currency:s.currency,exchangeRate:i.useAutoRate?w[r]||600:i.exchangeRate}))}},[l.country]),c.useEffect(()=>{if(a.amountSent>0&&!b){const s=g(a.amountSent,a.currency);h(r=>({...r,fees:s}))}},[a.amountSent,a.currency,b]);const V=l.country==="USA"&&n.country==="BFA",me=l.country==="BFA"&&n.country==="USA";let y,p;V?(y=Math.round(a.amountSent*a.exchangeRate),p="XOF"):me?(y=Math.round(a.amountSent/a.exchangeRate*100)/100,p="USD"):(y=Math.round(a.amountSent*a.exchangeRate),p="XOF");const z=a.amountSent+a.fees,de=l.firstName&&l.lastName&&l.phone&&l.country,oe=n.firstName&&n.lastName&&n.phone&&n.country&&n.city,xe=a.amountSent>0&&a.exchangeRate>0,q=()=>{switch(d){case 1:return de;case 2:return oe;case 3:return xe;default:return!0}},ue=()=>{d<4&&q()&&j(s=>s+1)},he=()=>{d>1&&j(s=>s-1)},pe=async()=>{R(!0);try{const s=g(a.amountSent,a.currency),r={sender:{firstName:l.firstName,lastName:l.lastName,phone:l.phone,email:l.email||void 0,country:l.country},beneficiary:{firstName:n.firstName,lastName:n.lastName,phone:n.phone,country:n.country,city:n.city,idType:n.idType!=="none"?n.idType:void 0,idNumber:n.idNumber||void 0},amountSent:a.amountSent,currency:a.currency,exchangeRate:a.exchangeRate,sendMethod:l.sendMethod,currencyReceived:p};b&&a.fees!==s&&(r.fees=a.fees);const i=await Ne.create(r);T(i.reference),j(5)}catch(s){console.error("Erreur cr√©ation transfert:",s);const r=s.message||"Erreur lors de la cr√©ation du transfert";r.includes("connecter au serveur")||r.includes("Failed to fetch")?alert(`‚ùå Impossible de se connecter au serveur.

V√©rifiez que le backend est d√©marr√© sur le port 5000.

Erreur: `+r):alert("‚ùå Erreur: "+r)}finally{R(!1)}},ge=()=>{navigator.clipboard.writeText(E),M(!0),setTimeout(()=>M(!1),2e3)},H=()=>{const s=N.find(r=>r.code===l.country);return(s==null?void 0:s.flag)||"üåç"},W=()=>{const s=C.find(r=>r.code===n.country);return(s==null?void 0:s.flag)||"üåç"};return t?e.jsxs("div",{className:"max-w-4xl mx-auto pb-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-8",children:[e.jsxs("button",{onClick:()=>m(-1),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-3 sm:mb-4 py-2 touch-manipulation",children:[e.jsx(Q,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Retour"})]}),e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-gray-900",children:"Nouvelle Transaction"}),e.jsxs("p",{className:"text-sm sm:text-base text-gray-600 mt-1",children:["Agent: ",t.name," ‚Ä¢ ",t.country||"Non d√©fini"]})]}),d<=4&&e.jsx("div",{className:"mb-4 sm:mb-8 overflow-x-auto scrollbar-hide -mx-3 px-3 sm:mx-0 sm:px-0",children:e.jsx("div",{className:"flex items-center justify-between min-w-[320px] sm:min-w-0",children:ee.map((s,r)=>{const i=s.icon,u=d===s.id,v=d>s.id;return e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:`
                      w-9 h-9 sm:w-10 md:w-12 sm:h-10 md:h-12 rounded-full flex items-center justify-center transition-all
                      ${u?"bg-emerald-500 text-white shadow-lg shadow-emerald-500/30":""}
                      ${v?"bg-emerald-500 text-white":""}
                      ${!u&&!v?"bg-gray-200 text-gray-500":""}
                    `,children:v?e.jsx(f,{className:"w-4 h-4 sm:w-5 md:w-6 sm:h-5 md:h-6"}):e.jsx(i,{className:"w-4 h-4 sm:w-5 md:w-6 sm:h-5 md:h-6"})}),e.jsx("span",{className:`mt-1 sm:mt-2 text-[10px] sm:text-xs md:text-sm font-medium text-center ${u?"text-emerald-600":"text-gray-500"}`,children:s.title})]}),r<ee.length-1&&e.jsx("div",{className:`h-0.5 sm:h-1 flex-1 mx-1 sm:mx-2 rounded ${v?"bg-emerald-500":"bg-gray-200"}`})]},s.id)})})}),e.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-lg sm:shadow-xl border border-gray-100 p-4 sm:p-6 md:p-8",children:[d===1&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 sm:mb-6",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-emerald-100 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"w-5 h-5 sm:w-6 sm:h-6 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Informations de l'exp√©diteur"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Personne qui envoie l'argent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Choisir un exp√©diteur existant (base de donn√©es)"}),e.jsxs("select",{value:ie??"",onChange:s=>{const r=s.target.value||null;if(X(r),r){const i=O.find(u=>u.id===r);i&&x({...l,firstName:i.firstName,lastName:i.lastName,phone:i.phone,email:i.email||"",country:l.country,sendMethod:l.sendMethod})}},disabled:le,className:"w-full px-3 sm:px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 text-base bg-white",children:[e.jsx("option",{value:"",children:"‚Äî Nouveau (saisie manuelle) ‚Äî"}),O.map(s=>e.jsxs("option",{value:s.id,children:[s.firstName," ",s.lastName," ‚Äî ",s.phone]},s.id))]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Pr√©nom *"}),e.jsx("input",{type:"text",value:l.firstName,onChange:s=>x({...l,firstName:s.target.value}),className:"w-full px-3 sm:px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 text-base",placeholder:"John"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Nom *"}),e.jsx("input",{type:"text",value:l.lastName,onChange:s=>x({...l,lastName:s.target.value}),className:"w-full px-3 sm:px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 text-base",placeholder:"Smith"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:[e.jsx(Z,{className:"w-4 h-4 inline mr-1"}),"T√©l√©phone *"]}),e.jsx("input",{type:"tel",value:l.phone,onChange:s=>x({...l,phone:s.target.value}),className:"w-full px-3 sm:px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 text-base",placeholder:"+1 555 123 4567"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:[e.jsx(ve,{className:"w-4 h-4 inline mr-1"}),"Email (optionnel)"]}),e.jsx("input",{type:"email",value:l.email,onChange:s=>x({...l,email:s.target.value}),className:"w-full px-3 sm:px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 text-base",placeholder:"john.smith@email.com"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(we,{className:"w-4 h-4 inline mr-1"}),"Pays d'envoi * ",t&&(F(t.country)?"(Burkina Faso)":"(√âtats-Unis)")]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 sm:gap-3",children:Ue(t==null?void 0:t.country).map(s=>e.jsxs("button",{type:"button",onClick:()=>x({...l,country:s.code}),className:`p-3 sm:p-4 rounded-xl border-2 transition-all touch-manipulation ${l.country===s.code?"border-emerald-500 bg-emerald-50":"border-gray-200 hover:border-gray-300 active:bg-gray-50"}`,children:[e.jsx("span",{className:"text-xl sm:text-2xl",children:s.flag}),e.jsx("p",{className:"text-xs sm:text-sm font-medium mt-1 truncate",children:s.name}),e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500",children:s.currency})]},s.code))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Se,{className:"w-4 h-4 inline mr-1"}),"Mode de paiement *"]}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-5 gap-2 sm:gap-3",children:se.map(s=>{const r=s.icon;return e.jsxs("button",{type:"button",onClick:()=>x({...l,sendMethod:s.id}),className:`p-2.5 sm:p-4 rounded-xl border-2 transition-all flex flex-col items-center touch-manipulation ${l.sendMethod===s.id?"border-emerald-500 bg-emerald-50":"border-gray-200 hover:border-gray-300 active:bg-gray-50"}`,children:[e.jsx(r,{className:`w-5 h-5 sm:w-6 sm:h-6 ${l.sendMethod===s.id?"text-emerald-600":"text-gray-500"}`}),e.jsx("span",{className:"text-[10px] sm:text-sm font-medium mt-1.5 sm:mt-2 text-center",children:s.label})]},s.id)})})]})]}),d===2&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 sm:mb-6",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Informations du b√©n√©ficiaire"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Personne qui re√ßoit l'argent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Choisir un b√©n√©ficiaire existant (base de donn√©es)"}),e.jsxs("select",{value:ce??"",onChange:s=>{const r=s.target.value||null;if(_(r),r){const i=I.find(u=>u.id===r);i&&o({...n,firstName:i.firstName,lastName:i.lastName,phone:i.phone,country:n.country,city:i.city||"",idType:n.idType,idNumber:n.idNumber})}},disabled:re,className:"w-full px-3 sm:px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-base bg-white",children:[e.jsx("option",{value:"",children:"‚Äî Nouveau (saisie manuelle) ‚Äî"}),I.map(s=>e.jsxs("option",{value:s.id,children:[s.firstName," ",s.lastName," ‚Äî ",s.phone," ",s.city?`(${s.city})`:""]},s.id))]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Pr√©nom *"}),e.jsx("input",{type:"text",value:n.firstName,onChange:s=>o({...n,firstName:s.target.value}),className:"w-full px-3 sm:px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-base",placeholder:"Amadou"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Nom *"}),e.jsx("input",{type:"text",value:n.lastName,onChange:s=>o({...n,lastName:s.target.value}),className:"w-full px-3 sm:px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-base",placeholder:"Ou√©draogo"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:[e.jsx(Z,{className:"w-4 h-4 inline mr-1"}),"T√©l√©phone *"]}),e.jsx("input",{type:"tel",value:n.phone,onChange:s=>o({...n,phone:s.target.value}),className:"w-full px-3 sm:px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-base",placeholder:"+226 70 12 34 56"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:[e.jsx(ke,{className:"w-4 h-4 inline mr-1"}),"Type de pi√®ce d'identit√©"]}),e.jsxs("select",{value:n.idType,onChange:s=>o({...n,idType:s.target.value}),className:"w-full px-3 sm:px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-base bg-white",children:[e.jsx("option",{value:"none",children:"Non fourni"}),e.jsx("option",{value:"national_id",children:"Carte d'identit√© nationale"}),e.jsx("option",{value:"passport",children:"Passeport"}),e.jsx("option",{value:"driver_license",children:"Permis de conduire"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Num√©ro de pi√®ce"}),e.jsx("input",{type:"text",value:n.idNumber,onChange:s=>o({...n,idNumber:s.target.value}),disabled:n.idType==="none",className:"w-full px-3 sm:px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 text-base",placeholder:"B1234567"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Ae,{className:"w-4 h-4 inline mr-1"}),"Pays de r√©ception *"]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 sm:gap-3",children:Oe(t==null?void 0:t.country).map(s=>e.jsxs("button",{type:"button",onClick:()=>o({...n,country:s.code}),className:`p-3 sm:p-4 rounded-xl border-2 transition-all touch-manipulation ${n.country===s.code?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 active:bg-gray-50"}`,children:[e.jsx("span",{className:"text-xl sm:text-2xl",children:s.flag}),e.jsx("p",{className:"text-xs sm:text-sm font-medium mt-1 truncate",children:s.name}),e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500",children:s.currency})]},s.code))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Ville *"}),e.jsx("input",{type:"text",value:n.city,onChange:s=>o({...n,city:s.target.value}),className:"w-full px-3 sm:px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-base",placeholder:"Ouagadougou"})]})]}),d===3&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 sm:mb-6",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-amber-100 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(ae,{className:"w-5 h-5 sm:w-6 sm:h-6 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Informations financi√®res"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Montant et taux de change"})]})]}),e.jsx("div",{className:"bg-gray-50 rounded-xl p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("span",{className:"text-xl sm:text-2xl flex-shrink-0",children:H()}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("p",{className:"font-medium text-sm sm:text-base truncate",children:[l.firstName," ",l.lastName]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 truncate",children:l.phone})]})]}),e.jsx(Y,{className:"w-5 h-5 sm:w-6 sm:h-6 text-gray-400 flex-shrink-0 mx-1"}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0 justify-end",children:[e.jsxs("div",{className:"text-right min-w-0",children:[e.jsxs("p",{className:"font-medium text-sm sm:text-base truncate",children:[n.firstName," ",n.lastName]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 truncate",children:n.city})]}),e.jsx("span",{className:"text-xl sm:text-2xl flex-shrink-0",children:W()})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:"Montant √† envoyer *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",min:"0",inputMode:"decimal",value:a.amountSent||"",onChange:s=>h({...a,amountSent:parseFloat(s.target.value)||0}),className:"w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-500 text-xl sm:text-2xl font-bold pr-16",placeholder:"100"}),e.jsx("span",{className:"absolute right-3 sm:right-4 top-1/2 -translate-y-1/2 text-gray-500 font-medium text-sm sm:text-base",children:a.currency})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 sm:mb-2",children:["Taux (",l.country==="USA"?`1 ${a.currency} = X XOF`:`1 XOF = X ${p}`,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",inputMode:"decimal",value:a.exchangeRate,onChange:s=>h({...a,exchangeRate:parseFloat(s.target.value)||0,useAutoRate:!1}),className:"flex-1 px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-amber-500 text-lg sm:text-xl font-bold min-w-0"}),e.jsx("button",{type:"button",onClick:()=>{const s=`${a.currency}_XOF`;h({...a,exchangeRate:w[s]||600,useAutoRate:!0})},className:`px-3 sm:px-4 py-2 rounded-xl text-sm font-medium transition-colors touch-manipulation flex-shrink-0 ${a.useAutoRate?"bg-emerald-100 text-emerald-700":"bg-gray-100 text-gray-600 hover:bg-gray-200 active:bg-gray-300"}`,children:"Auto"})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl sm:rounded-2xl p-4 sm:p-6 space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-700 mb-2 sm:mb-4",children:[e.jsx(Re,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"font-semibold text-sm sm:text-base",children:"Calcul automatique"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl p-3 sm:p-4",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Montant envoy√©"}),e.jsxs("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:[a.amountSent.toLocaleString()," ",e.jsx("span",{className:"text-sm sm:text-base",children:a.currency})]})]}),e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Frais"}),b&&e.jsx("button",{type:"button",onClick:()=>{const s=g(a.amountSent,a.currency);h(r=>({...r,fees:s})),U(!1)},className:"text-[10px] sm:text-xs text-emerald-600 hover:text-emerald-700 underline",title:"R√©initialiser aux frais automatiques",children:"Auto"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("input",{type:"number",inputMode:"decimal",min:"0",max:g(a.amountSent,a.currency),step:"0.01",value:a.fees,onChange:s=>{const r=parseFloat(s.target.value)||0,i=g(a.amountSent,a.currency);r<=i&&r>=0&&(h(u=>({...u,fees:r})),U(!0))},className:"text-lg sm:text-2xl font-bold text-amber-600 bg-transparent border-none p-0 w-full focus:outline-none focus:ring-0",style:{WebkitAppearance:"none",MozAppearance:"textfield"}}),e.jsx("span",{className:"text-sm sm:text-base text-amber-600",children:a.currency})]}),b&&e.jsxs("p",{className:"text-[10px] sm:text-xs text-gray-400 mt-1",children:["Max: ",g(a.amountSent,a.currency)," ",a.currency]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl p-3 sm:p-4",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Total pay√© par l'exp√©diteur"}),e.jsxs("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:[z.toLocaleString()," ",a.currency]})]}),e.jsxs("div",{className:"bg-emerald-600 rounded-xl p-4 sm:p-6 text-white",children:[e.jsx("p",{className:"text-xs sm:text-sm text-emerald-100",children:"Montant √† remettre au b√©n√©ficiaire"}),e.jsxs("p",{className:"text-2xl sm:text-3xl md:text-4xl font-bold",children:[y.toLocaleString()," ",e.jsx("span",{className:"text-lg sm:text-xl",children:p})]}),e.jsx("p",{className:"text-xs sm:text-sm text-emerald-100 mt-2",children:V?`Taux: 1 ${a.currency} = ${a.exchangeRate.toLocaleString()} XOF`:`Taux: 1 XOF = ${(1/a.exchangeRate).toFixed(4)} ${p}`})]})]})]}),d===4&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 sm:mb-6",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-purple-100 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(f,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Confirmation"}),e.jsx("p",{className:"text-sm text-gray-500",children:"V√©rifiez avant de valider"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 sm:p-5",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 sm:mb-3 flex items-center gap-2 text-sm sm:text-base",children:[e.jsx("span",{className:"text-lg sm:text-xl",children:H()}),"Exp√©diteur"]}),e.jsxs("div",{className:"space-y-1.5 sm:space-y-2 text-xs sm:text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Nom:"})," ",l.firstName," ",l.lastName]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"T√©l:"})," ",l.phone]}),l.email&&e.jsxs("p",{className:"truncate",children:[e.jsx("span",{className:"text-gray-500",children:"Email:"})," ",l.email]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Pays:"})," ",(G=N.find(s=>s.code===l.country))==null?void 0:G.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Paiement:"})," ",(K=se.find(s=>s.id===l.sendMethod))==null?void 0:K.label]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 sm:p-5",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 sm:mb-3 flex items-center gap-2 text-sm sm:text-base",children:[e.jsx("span",{className:"text-lg sm:text-xl",children:W()}),"B√©n√©ficiaire"]}),e.jsxs("div",{className:"space-y-1.5 sm:space-y-2 text-xs sm:text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Nom:"})," ",n.firstName," ",n.lastName]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"T√©l:"})," ",n.phone]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Ville:"})," ",n.city]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"Pays:"})," ",(J=C.find(s=>s.code===n.country))==null?void 0:J.name]}),n.idType!=="none"&&e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500",children:"ID:"})," ",n.idNumber]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-emerald-600 to-teal-700 rounded-xl sm:rounded-2xl p-4 sm:p-6 text-white",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] sm:text-sm text-emerald-100",children:"Envoy√©"}),e.jsx("p",{className:"text-sm sm:text-lg md:text-2xl font-bold",children:a.amountSent.toLocaleString()}),e.jsx("p",{className:"text-[10px] sm:text-xs text-emerald-200",children:a.currency})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] sm:text-sm text-emerald-100",children:"Frais"}),e.jsx("p",{className:"text-sm sm:text-lg md:text-2xl font-bold",children:a.fees.toLocaleString()}),e.jsx("p",{className:"text-[10px] sm:text-xs text-emerald-200",children:a.currency})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] sm:text-sm text-emerald-100",children:"√Ä remettre"}),e.jsx("p",{className:"text-sm sm:text-lg md:text-2xl font-bold",children:y.toLocaleString()}),e.jsx("p",{className:"text-[10px] sm:text-xs text-emerald-200",children:p})]})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 pt-3 sm:pt-4 border-t border-white/20 text-center",children:[e.jsx("p",{className:"text-xs sm:text-sm text-emerald-100",children:"Total pay√©"}),e.jsxs("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold",children:[z.toLocaleString()," ",a.currency]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 sm:p-4 bg-blue-50 rounded-xl",children:[e.jsx(Ee,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Cr√©√© par"}),e.jsxs("p",{className:"font-medium text-sm sm:text-base truncate",children:[t.name," ‚Ä¢ ",new Date().toLocaleString("fr-FR")]})]})]})]}),d===5&&e.jsxs("div",{className:"text-center py-4 sm:py-8",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4 sm:mb-6",children:e.jsx(f,{className:"w-8 h-8 sm:w-10 sm:h-10 text-emerald-600"})}),e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-2",children:"Transaction cr√©√©e!"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-4 sm:mb-6 px-2",children:"En attente de paiement par l'agent local."}),e.jsxs("div",{className:"bg-gray-50 rounded-xl sm:rounded-2xl p-4 sm:p-6 max-w-md mx-auto mb-4 sm:mb-8",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mb-2",children:"Num√©ro de r√©f√©rence"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-3",children:[e.jsx("span",{className:"text-xl sm:text-2xl md:text-3xl font-mono font-bold text-emerald-600 break-all",children:E}),e.jsx("button",{onClick:ge,className:"p-2 hover:bg-gray-200 active:bg-gray-300 rounded-lg transition-colors touch-manipulation flex-shrink-0",title:"Copier",children:ne?e.jsx(f,{className:"w-5 h-5 text-emerald-600"}):e.jsx(Te,{className:"w-5 h-5 text-gray-500"})})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-400 mt-2",children:"Communiquez cette r√©f√©rence au b√©n√©ficiaire"})]}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-3 sm:p-4 max-w-md mx-auto mb-4 sm:mb-8",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-amber-700",children:[e.jsx(Me,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"font-medium text-sm sm:text-base",children:"EN ATTENTE DE PAIEMENT"})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3 sm:gap-4 px-2",children:[e.jsx("button",{onClick:()=>m("/transfers"),className:"w-full sm:w-auto px-5 sm:px-6 py-3 bg-gray-200 text-gray-700 rounded-xl font-medium hover:bg-gray-300 active:bg-gray-400 transition-colors touch-manipulation order-2 sm:order-1",children:"Voir les transferts"}),e.jsxs("button",{onClick:()=>{j(1),x({firstName:"",lastName:"",phone:"",email:"",country:"USA",sendMethod:"cash"}),o({firstName:"",lastName:"",phone:"",idType:"none",idNumber:"",country:"BFA",city:""}),h({amountSent:0,currency:"USD",exchangeRate:w.USD_XOF,useAutoRate:!0,fees:0}),T("")},className:"w-full sm:w-auto px-5 sm:px-6 py-3 bg-emerald-600 text-white rounded-xl font-medium hover:bg-emerald-700 active:bg-emerald-800 transition-colors flex items-center justify-center gap-2 touch-manipulation order-1 sm:order-2",children:[e.jsx(Be,{className:"w-5 h-5"}),"Nouvelle transaction"]})]})]}),d<=4&&e.jsxs("div",{className:"flex justify-between mt-6 sm:mt-8 pt-4 sm:pt-6 border-t border-gray-100 gap-3",children:[e.jsxs("button",{onClick:he,disabled:d===1,className:"flex-1 sm:flex-none px-4 sm:px-6 py-3 flex items-center justify-center gap-2 text-gray-600 hover:text-gray-900 active:bg-gray-100 rounded-xl disabled:opacity-50 disabled:cursor-not-allowed touch-manipulation",children:[e.jsx(Q,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden xs:inline",children:"Retour"})]}),d<4?e.jsxs("button",{onClick:ue,disabled:!q(),className:"flex-1 sm:flex-none px-6 sm:px-8 py-3 bg-emerald-600 text-white rounded-xl font-medium hover:bg-emerald-700 active:bg-emerald-800 transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed touch-manipulation",children:[e.jsx("span",{children:"Suivant"}),e.jsx(Y,{className:"w-5 h-5"})]}):e.jsx("button",{onClick:pe,disabled:A,className:"flex-1 sm:flex-none px-5 sm:px-8 py-3 bg-emerald-600 text-white rounded-xl font-medium hover:bg-emerald-700 active:bg-emerald-800 transition-colors flex items-center justify-center gap-2 disabled:opacity-50 touch-manipulation",children:A?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"hidden sm:inline",children:"Cr√©ation..."}),e.jsx("span",{className:"sm:hidden",children:"..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Cr√©er la transaction"}),e.jsx("span",{className:"sm:hidden",children:"Cr√©er"})]})})]})]})]}):null};export{Le as NewTransfer};
