import{r as g,j as e}from"./react-PleRxLNr.js";import{D as h}from"./DataTable-CWvM5oaM.js";import{S as C,j as D,F as b,k as S,a4 as T,g as F}from"./lucide-DAQsc5bm.js";const A=({onSubmit:r,onCancel:d,file:s})=>{const[t,x]=g.useState({reference:(s==null?void 0:s.reference)||"",fileType:(s==null?void 0:s.fileType)||"DAU",status:(s==null?void 0:s.status)||"initiated",goodsDescription:(s==null?void 0:s.goodsDescription)||"",originCountry:(s==null?void 0:s.originCountry)||"",destinationCountry:(s==null?void 0:s.destinationCountry)||"",estimatedDuties:(s==null?void 0:s.estimatedDuties)||0,assignedAgent:(s==null?void 0:s.assignedAgent)||"",client:(s==null?void 0:s.client)||""}),a=c=>{const{name:l,value:u}=c.target;x(m=>({...m,[l]:l==="estimatedDuties"?Number(u):u}))},i=c=>{c.preventDefault(),r(t)};return e.jsxs("form",{onSubmit:i,className:"bg-white p-6 rounded-lg shadow-md space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Référence"}),e.jsx("input",{type:"text",name:"reference",value:t.reference,onChange:a,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de dossier"}),e.jsxs("select",{name:"fileType",value:t.fileType,onChange:a,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"DAU",children:"DAU (Déclaration d'Accompagnement des Usages)"}),e.jsx("option",{value:"DSI",children:"DSI (Déclaration Sommaire d'Importation)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statut"}),e.jsxs("select",{name:"status",value:t.status,onChange:a,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"initiated",children:"Initié"}),e.jsx("option",{value:"in_progress",children:"En cours"}),e.jsx("option",{value:"submitted",children:"Soumis"}),e.jsx("option",{value:"approved",children:"Approuvé"}),e.jsx("option",{value:"rejected",children:"Rejeté"}),e.jsx("option",{value:"closed",children:"Clôturé"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Agent assigné"}),e.jsx("input",{type:"text",name:"assignedAgent",value:t.assignedAgent,onChange:a,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client"}),e.jsx("input",{type:"text",name:"client",value:t.client,onChange:a,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pays d'origine"}),e.jsx("input",{type:"text",name:"originCountry",value:t.originCountry,onChange:a,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pays de destination"}),e.jsx("input",{type:"text",name:"destinationCountry",value:t.destinationCountry,onChange:a,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Droits estimés (FCFA)"}),e.jsx("input",{type:"number",name:"estimatedDuties",value:t.estimatedDuties,onChange:a,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description des marchandises"}),e.jsx("textarea",{name:"goodsDescription",value:t.goodsDescription,onChange:a,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:d,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Annuler"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:s?"Modifier":"Créer"})]})]})},R=({onSubmit:r,onCancel:d,classification:s})=>{const[t,x]=g.useState({code:(s==null?void 0:s.code)||"",description:(s==null?void 0:s.description)||"",dutyRate:(s==null?void 0:s.dutyRate)||0,vatRate:(s==null?void 0:s.vatRate)||0,validFrom:(s==null?void 0:s.validFrom)||new Date().toISOString().split("T")[0]}),a=c=>{const{name:l,value:u}=c.target;x(m=>({...m,[l]:l==="dutyRate"||l==="vatRate"?Number(u):u}))},i=c=>{c.preventDefault(),r(t)};return e.jsxs("form",{onSubmit:i,className:"bg-white p-6 rounded-lg shadow-md space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Code TARIC"}),e.jsx("input",{type:"text",name:"code",value:t.code,onChange:a,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Taux de droits (%)"}),e.jsx("input",{type:"number",name:"dutyRate",value:t.dutyRate,onChange:a,step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Taux TVA (%)"}),e.jsx("input",{type:"number",name:"vatRate",value:t.vatRate,onChange:a,step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valable à partir de"}),e.jsx("input",{type:"date",name:"validFrom",value:t.validFrom,onChange:a,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:t.description,onChange:a,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:d,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Annuler"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:s?"Modifier":"Créer"})]})]})},M=({files:r,classifications:d,onAddFile:s,onUpdateFile:t,onAddClassification:x})=>{const[a,i]=g.useState(!1),[c,l]=g.useState(!1),[u,m]=g.useState(null),[n,p]=g.useState(""),j=o=>{u?t(u.id,o):s(o),i(!1),m(null)},y=o=>{m(o),i(!0)},v=o=>{x(o),l(!1)},f=[{header:"Référence",accessor:"reference"},{header:"Type",accessor:"fileType"},{header:"Statut",accessor:"status"},{header:"Client",accessor:"client"},{header:"Droits estimés",accessor:"estimatedDuties",render:o=>o.toLocaleString("fr-FR")+" FCFA"},{header:"Agent assigné",accessor:"assignedAgent"},{header:"Actions",accessor:o=>e.jsxs("button",{onClick:()=>y(o),className:"text-blue-600 hover:text-blue-900 flex items-center",children:[e.jsx(S,{className:"w-4 h-4 mr-1"})," Modifier"]})}],N=[{header:"Code",accessor:"code"},{header:"Description",accessor:"description"},{header:"Taux de droits (%)",accessor:"dutyRate"},{header:"Taux TVA (%)",accessor:"vatRate"},{header:"Valable à partir",accessor:"validFrom"}],w=r.filter(o=>o.reference.toLowerCase().includes(n.toLowerCase())||o.client.toLowerCase().includes(n.toLowerCase())||o.goodsDescription.toLowerCase().includes(n.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Gestion des dossiers de transit"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Rechercher...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:n,onChange:o=>p(o.target.value)}),e.jsx(C,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]}),e.jsxs("button",{onClick:()=>{m(null),i(!0)},className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[e.jsx(D,{className:"w-4 h-4 mr-1"})," Nouveau dossier"]}),e.jsxs("button",{onClick:()=>l(!0),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:[e.jsx(b,{className:"w-4 h-4 mr-1"})," Classification TARIC"]})]})]}),a&&e.jsx(A,{onSubmit:j,onCancel:()=>{i(!1),m(null)},file:u||void 0}),c&&e.jsx(R,{onSubmit:v,onCancel:()=>l(!1)}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx(h,{data:w,columns:f})}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center",children:[e.jsx(b,{className:"w-5 h-5 text-blue-600 mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Classifications TARIC"})]}),e.jsx(h,{data:d,columns:N})]})]})},k=({tracking:r})=>{const d=s=>{switch(s){case"approved":return"text-green-600 bg-green-100";case"rejected":return"text-red-600 bg-red-100";case"processing":return"text-yellow-600 bg-yellow-100";case"pending":return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}};return e.jsx("div",{className:"border-l-4 border-blue-500 pl-4 py-2 ml-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${d(r.status)}`,children:[r.status==="pending"&&"En attente",r.status==="processing"&&"En traitement",r.status==="approved"&&"Approuvé",r.status==="rejected"&&"Rejeté"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.administration})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:new Date(r.updateDate).toLocaleDateString()}),r.comments&&e.jsxs("p",{className:"text-xs text-gray-600 mt-1 italic",children:['"',r.comments,'"']})]})]})})},q=({file:r,trackings:d})=>{const s=t=>{switch(t){case"approved":return"text-green-600";case"rejected":return"text-red-600";case"processing":return"text-yellow-600";case"pending":return"text-gray-600";default:return"text-gray-600"}};return e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800",children:[r.reference," - ",r.fileType]}),e.jsx("p",{className:"text-gray-600",children:r.goodsDescription})]}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${s(r.status)}`,children:[r.status==="initiated"&&"Initié",r.status==="in_progress"&&"En cours",r.status==="submitted"&&"Soumis",r.status==="approved"&&"Approuvé",r.status==="rejected"&&"Rejeté",r.status==="closed"&&"Clôturé"]})]}),e.jsx("div",{className:"border-l-2 border-gray-200 pl-4",children:d.map((t,x)=>e.jsx(k,{tracking:t},x))})]})},P=({files:r,trackings:d,onTrackUpdate:s})=>{const[t,x]=g.useState(null),[a,i]=g.useState(!1),c=()=>{if(!t)return;const n={fileId:t,administration:"Direction des Douanes",status:"pending",updateDate:new Date().toISOString(),comments:"Nouvelle mise à jour"};s(n)},l=[{header:"Référence",accessor:"reference"},{header:"Type",accessor:"fileType"},{header:"Client",accessor:"client"},{header:"Statut",accessor:"status"},{header:"Pays destination",accessor:"destinationCountry"},{header:"Actions",accessor:n=>e.jsx("div",{className:"flex space-x-2",children:e.jsxs("button",{onClick:()=>{x(n.id),i(!0)},className:"text-blue-600 hover:text-blue-900 flex items-center",children:[e.jsx(F,{className:"w-4 h-4 mr-1"})," Suivre"]})})}],u=[{header:"Dossier",accessor:"fileId"},{header:"Administration",accessor:"administration"},{header:"Statut",accessor:"status"},{header:"Date",accessor:"updateDate",render:n=>new Date(n).toLocaleDateString()},{header:"Commentaires",accessor:"comments"}],m=t?d.filter(n=>n.fileId===t):d;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Suivi des dossiers - Liaisons administrations"})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Liste des dossiers"}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx(h,{data:r,columns:l})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Suivi des administrations"}),t&&e.jsxs("button",{onClick:c,className:"flex items-center px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:[e.jsx(T,{className:"w-3 h-3 mr-1"})," Nouvelle mise à jour"]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx(h,{data:m,columns:u})})]})]}),a&&t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Détails du suivi"}),e.jsx("button",{onClick:()=>i(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),e.jsx("div",{className:"p-6",children:e.jsx(q,{file:r.find(n=>n.id===t),trackings:d.filter(n=>n.fileId===t)})})]})})]})};export{P as A,M as T};
